# Учебный проект на тему: "Веб-приложение для управления кондитерской"

В данном проекте перед нами была поставлена задача разработать информационную систему,
предназначенную для обеспечения работы производства праздничных тортов на заказ.

Система предназначена для пяти типов пользователей:

- заказчик;
- менеджер по работе с клиентами;
- менеджер по закупкам;
- мастер;
- директор.

С полным описанием функционала данного проекта можно ознакомиться в PDF-файлах, находящихся в папке `./docs`.

> На данный момент наиболее полной по функционалу является backend-составляющая проекта.
> Frontend-составляющая проекта все еще находится на стадии разработки.

## Запуск проекта

Данный проект активно использует технологию docker-контейнеров для более удобного запуска на различных устройствах.
Для полноценного запуска необходимо:

1. Склонировать / скачать данный репозиторий на свой компьютер.
2. Перейти в папку `./backend/gateway`.

   ```sh
   cd ./backend/gateway/
   ```

3. Запустить все контейнеры в данном микросервисе:

   ```sh
   make up
   ```

   > Будьте осторожны: в данном микросервисе хранится и запускается база данных.
   > При запуске ей может понадобится некоторое время, прежде чем вы сможете хоть как-то с ней взаимодействовать.
   > Если вы не можете отправить запрос к БД, проверьте вывод внутри контейнера с базой данных.

4. (При первом запуске) применить миграции к базе данных MySQL:

   - Если установлен язык go и все пакеты из файла `go.mod`, то вы можете запустить мигратор локально:

     ```sh
     make local-migrate
     ```

   - В ином случае вы можете запустить мигратор внутри docker-контейнере с помощью команды:

     ```sh
     make migrate
     ```

5. Далее нужно запустить все оставшиеся микросервисы. Это можно сделать следующими способами:
   - В терминале (или командной строке) поочередно перейти в папку каждого микросервиса и применить команду `make up`.
   - В терминале перейти в каталог `backend` и применить команду `make up` там. Данное действие запустит все микросервисы в проекте.

## Используемые технологии и подходы

- Язык программирования Golang
  - Веб-фреймворк GoFiber
  - Библиотека для работы с БД GORM
  - REST
  - GRPC
    - GRPC-gateway
    - GRPC-openapiv2
      - генерация swagger на основе protobuf
- СУБД MySQL
  - PhpMyAdmin
  - Библиотека для миграций golang-migrate
- Docker
- Чистая архитектура с разделением на домены (Основные слои: controller/handler, usecase, service, repository)
- Авторизация с помощью JWT-access/refresh токенов

## Структура проекта

В данном проекте использовалась чистая архитектура кода с разделением на домены.
Основные слои:

- controller/handler,
- usecase,
- service\*,
- repository

> \* - используется не очень часто

За исключением микросервиса `tools`, все микросервисы используют архитектурный стиль REST с фреймворком GoFiber.
микросервисе `tools` используется подход GRPC и все соответствующие ему библиотеки.

### Микросервис gateway

Основной микросервис, через который frontend может взаимодействовать с backend.

Основной функционал:

- Маршрутизация запросов между микросервисами
- Регистрация основных рутов
- Работа с пользователями
- Хранение базы данных и админки для нее

### Микросервис components

Микросервис для работы с компонентами — ингредиентами и декорациями для кондитерских изделий.

Основной функционал:

- Учет ингредиентов и украшений для тортов
- Списание ингредиентов
- Оценка минимального времени производства
- Оценка затрат ингредиентов и украшений для тортов и времени доставки
- Построение диаграммы ганта для производства заказа (в виде структуры)
- Отчет по ингредиентам и украшениям для торта

### Микросервис orders

Микросервис для работы с заказами.

Основной функционал:

- Список заказов
- Проведение заказа по его жизненному циклу
- Оформление заказа
- Контроль качества изделий
- Спецификация изделий

### Микросервис tools

Микросервис для работы с оборудованием.

- Учет инструментов
- Сбои оборудования
- Отчет по закупкам инструмента
- Отчет по сбоям оборудования

### Примерная структура папок

```
./backend
│
└── tools  // Пример содержания микросервиса
    ├── cmd
    │   └── main
    ├── configs
    ├── internal
    │   ├── app
    │   ├── controllers
    │   ├── domains
    │   │   └── tool
    │   │       ├── controller
    │   │       ├── deps
    │   │       ├── params
    │   │       ├── repo
    │   │       │   └── mysql
    │   │       └── usecase
    │   └── models
    └── storage

./proto
├── api
│   └── tool_type
│       ├── models.proto
│       └── service.proto
├── docker-compose.yaml
├── go.mod
├── google
│   ├── api
│   │   ├── annotations.proto
│   │   ├── field_behavior.proto
│   │   ├── httpbody.proto
│   │   └── http.proto
│   └── protobuf
│       └── timestamp.proto
├── go.sum
├── Makefile
├── pkg
│   └── api
│       └── tool_type
│           ├── models.pb.go
│           ├── service_grpc.pb.go
│           ├── service.pb.go
│           └── service.pb.gw.go
└── swagger
    └── swagger.swagger.json
```
